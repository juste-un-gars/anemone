# Translation Guide (i18n)

## Overview

Anemone uses JSON-based translation files for internationalization.

**Current languages:**
- French (fr) - 580+ keys
- English (en) - 580+ keys

## Adding a New Language

### 1. Copy Translation File

```bash
cd internal/i18n/locales
cp fr.json de.json  # Example: German
```

### 2. Translate Values

Edit `de.json` and translate all values (keep keys unchanged):

```json
{
  "login.title": "Anmeldung bei Anemone",
  "login.username": "Benutzername",
  "login.password": "Passwort",
  "login.button": "Einloggen",
  ...
}
```

### 3. Register Language

Edit `internal/i18n/i18n.go`:

```go
// Add to imports if needed
var supportedLanguages = []string{"fr", "en", "de"}

// Add to Init function
func Init(defaultLang string) error {
    // ... existing code ...

    // Load German
    if err := loadTranslations("de"); err != nil {
        return err
    }
}
```

### 4. Add to Language Selector

Edit `internal/i18n/i18n.go`:

```go
func GetAvailableLanguages() []Language {
    return []Language{
        {Code: "fr", Name: "Français"},
        {Code: "en", Name: "English"},
        {Code: "de", Name: "Deutsch"},  // Add new language
    }
}
```

### 5. Compile and Test

```bash
go build -o anemone cmd/anemone/main.go
./anemone
```

## Translation File Structure

### Key Naming Convention

```
section.subsection.item
```

Examples:
- `login.title` - Login page title
- `dashboard.welcome` - Dashboard welcome message
- `admin.users.add` - Admin users add button

### Placeholders

Use `{{name}}` for dynamic values:

```json
{
  "dashboard.welcome": "Welcome, {{username}}!",
  "quota.usage": "{{used}} of {{total}} used"
}
```

### Pluralization

Use separate keys:

```json
{
  "files.count.one": "1 file",
  "files.count.other": "{{count}} files"
}
```

## Translation Keys by Section

| Section | Prefix | Count |
|---------|--------|-------|
| Setup wizard | `setup.*` | ~50 |
| Login/Auth | `login.*`, `activate.*` | ~30 |
| Dashboard | `dashboard.*` | ~40 |
| Admin | `admin.*` | ~100 |
| Users | `users.*` | ~40 |
| Peers | `peers.*` | ~30 |
| Sync | `sync.*` | ~40 |
| Settings | `settings.*` | ~30 |
| Restore | `restore.*` | ~50 |
| Errors | `errors.*` | ~30 |
| Common | `common.*` | ~50 |

## Testing Translations

### Check for Missing Keys

```bash
# Compare key counts
cat internal/i18n/locales/fr.json | grep -c ":"
cat internal/i18n/locales/en.json | grep -c ":"
cat internal/i18n/locales/de.json | grep -c ":"
```

### Find Untranslated Keys

Keys missing in a language will fall back to English, then show the key itself.

Look for:
- Text that appears as `key.name.here`
- English text when French is selected

## Best Practices

### For Translators

1. **Keep placeholders** - Don't translate `{{username}}`
2. **Match length** - Similar length avoids UI issues
3. **Context matters** - Check where text appears in UI
4. **Be consistent** - Use same term for same concept

### For Developers

1. **Always use T()** - Never hardcode strings
2. **Add to both files** - Add new keys to all languages
3. **Use descriptive keys** - `admin.users.delete.confirm` not `msg1`
4. **Document placeholders** - Comment what `{{value}}` contains

## File Location

```
internal/i18n/
├── i18n.go           # Translation logic
└── locales/
    ├── fr.json       # French translations
    ├── en.json       # English translations
    └── README.md     # This guide (copy)
```

## Template Usage

In HTML templates:

```html
{{T .Lang "login.title"}}
{{T .Lang "dashboard.welcome" "username" .Username}}
```

In Go code:

```go
import "github.com/juste-un-gars/anemone/internal/i18n"

msg := i18n.T(lang, "error.not_found")
msg := i18n.T(lang, "welcome", "username", user.Name)
```

## Contributing Translations

1. Fork the repository
2. Add/update translation file
3. Test thoroughly
4. Submit pull request

Contributions welcome for any language!

## See Also

- [User Guide](user-guide.md) - Language settings
- [Installation](installation.md) - Default language
