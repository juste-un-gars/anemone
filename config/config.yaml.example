# ===== CONFIGURATION ANEMONE =====

node:
  name: "anemone-home"
  role: "primary"
  description: "Mon serveur personnel"

storage:
  # Chemin des données à sauvegarder (sera sauvegardé chez les pairs)
  backup_data_path: "/mnt/backup"
  # Chemin des données locales uniquement (non sauvegardé)
  local_data_path: "/mnt/data"
  # Chemin de réception des backups des autres serveurs
  backup_receive_path: "/mnt/backups"
  max_backup_size: "2TB"
  disk_alert_threshold: 90

services:
  smb:
    enabled: true
    port: 445
    workgroup: "WORKGROUP"
    share_name: "data"
    username: "anemone"
    password: "changeme"
    read_only: false
    
  webdav:
    enabled: true
    port: 8080
    ssl: false
    username: "anemone"
    password: "changeme"
    
  sftp:
    enabled: false
    port: 22222
    username: "anemone"

wireguard:
  interface: "wg0"
  listen_port: 51820
  private_key_file: "/config/wireguard/private.key"
  address: "10.8.0.1/24"
  public_endpoint: "votre-nom.duckdns.org:51820"
  dns: "1.1.1.1"
  mtu: 1420

peers: []
  # - name: "alice"
  #   endpoint: "alice.duckdns.org:51820"
  #   public_key: "REMPLACEZ_PAR_CLE_PUBLIQUE_ALICE"
  #   allowed_ips: "10.8.0.2/32"
  #   persistent_keepalive: 25

backup:
  engine: "restic"
  mode: "scheduled"
  debounce: 30
  interval: 30
  schedule: "0 2 * * *"
  password_file: "/config/restic-password"
  
  targets: []
    # - name: "alice-backup"
    #   enabled: true
    #   type: "sftp"
    #   host: "10.8.0.2"
    #   port: 22222
    #   user: "restic"
    #   path: "/backups/home"
  
  keep_last: 10
  keep_daily: 7
  keep_weekly: 4
  keep_monthly: 6
  keep_yearly: 2
  
  exclude:
    - "*.tmp"
    - "*.cache"
    - ".Trash-*"
    - "node_modules/"
    - "__pycache__/"
  
  bandwidth_limit: 0
  parallel: 4
  check_every: 30

restic_server:
  enabled: true
  port: 22222
  username: "restic"
  authorized_keys: []
  max_size_per_peer: "10GB"  # Espace disque maximum par pair (5GB/10GB/20GB/50GB/100GB/200GB/500GB ou 0 pour illimité)

monitoring:
  health_check_interval: 300
  alert_email: ""
  alert_webhook: ""
  alert_on_backup_fail: true
  alert_on_disk_full: true
  alert_on_vpn_down: true
  log_level: "info"
  log_max_size: "100MB"
  log_max_age: 30

advanced:
  timezone: "Europe/Paris"
  compression: true
  auto_update: false
  api_port: 3000
  prometheus_metrics: false
  prometheus_port: 9090
